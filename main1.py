# -*- coding: utf-8 -*-
"""main1.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/181Eo7BnA2HW8EG88vTFUP86y7OKiSsRf
"""

import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
import scipy as sp

from sklearn.feature_selection import SelectKBest
from sklearn.feature_selection import chi2
from sklearn.feature_selection import RFE
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn import metrics
import seaborn as sns
from sklearn.linear_model import Ridge
from sklearn.feature_selection import mutual_info_classif

names = ['purchase_sequence', 'style_id','article_type','gender','Revenue','Return_Reason','orders','Total Revenue','Return Value','RTO Value','RGM','Items','Return Items','RTO Items','return_q2_cogs','Return_Duration','Inv_Age','mserve','Q2_perc','CA_Q2_perc','scm_cost','GP','is_return' ]
names1 = ['purchase_sequence', 'style_id','article_type','gender','Revenue','Return_Reason','orders','Total Revenue','Return Value','RTO Value','RGM','Items','Return Items','RTO Items','return_q2_cogs','Return_Duration','Inv_Age','mserve','Q2_perc','CA_Q2_perc','scm_cost','GP' ]


url = "https://raw.githubusercontent.com/zeus1912/dataset/main/fdata.csv"
dataframe = pd.read_csv(url, names=names)
array = dataframe.values
X = array[:,0:22]
y = array[:,22]

myntra_mutual_information = mutual_info_classif(X, y)

plt.subplots(1, figsize=(26, 1))
sns.heatmap(myntra_mutual_information[:, np.newaxis].T, cmap='Blues', cbar=False, linewidths=1, annot=True)
plt.yticks([], [])
plt.gca().set_xticklabels(names, rotation=45, ha='right', fontsize=12)
plt.suptitle("Myntra Return Abuse Variable Importance (mutual_info_classif)", fontsize=18, y=1.2)
plt.gcf().subplots_adjust(wspace=0.2)
pass

